(()=>{var e={};e.id=931,e.ids=[931],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},7147:e=>{"use strict";e.exports=require("fs")},1017:e=>{"use strict";e.exports=require("path")},4940:(e,s,a)=>{"use strict";a.r(s),a.d(s,{GlobalError:()=>i.a,__next_app__:()=>u,originalPathname:()=>m,pages:()=>x,routeModule:()=>h,tree:()=>c});var t=a(3137),r=a(4647),l=a(4183),i=a.n(l),n=a(1775),d={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>n[e]);a.d(s,d);let o=t.AppPageRouteModule,c=["",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,4267)),"/Users/ivesluo/Desktop/perp_fees/app/page.tsx"]}]},{layout:[()=>Promise.resolve().then(a.bind(a,9958)),"/Users/ivesluo/Desktop/perp_fees/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,1918,23)),"next/dist/client/components/not-found-error"]}],x=["/Users/ivesluo/Desktop/perp_fees/app/page.tsx"],m="/page",u={require:a,loadChunk:()=>Promise.resolve()},h=new o({definition:{kind:r.x.APP_PAGE,page:"/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},9268:(e,s,a)=>{Promise.resolve().then(a.bind(a,715))},715:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>ev});var t=a(80),r=a(9885),l=a(7114),i=a(7588);let n=i.Ry({volume:i.Rx().min(0),fee:i.Rx()}),d=i.Ry({exchange:i.Z_().min(1),type:i.Km(["CEX","DEX","Nado"]),product:i.Km(["perp","spot"]),day_basis:i.Rx().int().positive(),maker_fees:i.IX(n).min(1),taker_fees:i.IX(n).min(1)});function o(e,s){let a=e[0]?.fee??0;for(let t of e)if(s>=t.volume)a=t.fee;else break;return a}function c(e,s){if(s<=0)return 0;let a=0;for(let t=0;t<e.length;t++){let r=e[t],l=e[t+1];if(s<r.volume)continue;let i=r.volume,n=l?Math.min(s,l.volume):s;if(n>i){let e=(n-i)*1e6,s=r.fee/1e4,t=e*s;a+=t}}return a}function x(e){return e>=1e3?`$${(e/1e3).toFixed(1)}B`:e>=1?`$${e.toFixed(1)}M`:`$${(1e3*e).toFixed(0)}K`}function m(e){return`${e>=0?"+":""}${e.toFixed(1)}bps`}function u(e){return`$${e.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})}`}function h(e,s,a){if(a){let e=Math.floor(Math.log10(1)),a=Math.ceil(Math.log10(s)),t=[];for(let r=e;r<=a;r++){let e=Math.pow(10,r);t.push(e),5*e<=s&&t.push(5*e)}return t.filter(e=>e>=1&&e<=s)}{let a;let t=s-e;a=t<=20?5:t<=100?10:t<=500?50:t<=2e3?100:t<=5e3?500:1e3;let r=Math.max(0,Math.floor(e/a)*a),l=Math.ceil(s/a)*a,i=[];for(let t=r;t<=l;t+=a)t>=e&&t<=s&&i.push(t);if(i.length<3){let t=a/2,i=[];for(let a=r;a<=l;a+=t)a>=e&&a<=s&&i.push(a);return i}return i}}i.Ry({exchanges:i.IX(d).min(1)});let f={Binance:"#F0B90B",Bybit:"#F7931A",Kraken:"#5C4B99",OKX:"#0066CC",Coinbase:"#0052FF",Hyperliquid:"#00D2FF",EdgeX:"#FF6B35",Jupiter:"#C147E9",Drift:"#9945FF","ApeX Protocol":"#00FFB3",Aster:"#FF4081",GMX:"#4DABF7",Vertex:"#7C3AED",ParaDex:"#10B981",Nado:"#FF1744"};var p=a(3647),g=a(6746),j=a(4300),v=a(5522),y=a(4025),b=a(1815),N=a(177),k=a(2640),F=a(9137);function w({exchanges:e,feeType:s,volumeDomain:a,feeDomain:l,isLogScale:i,hoverVolume:n,onHoverChange:d,colors:f}){let[w,C]=(0,r.useState)(null),[_,D]=(0,r.useState)(!1),{chartData:M,stepMarkers:S}=(0,r.useMemo)(()=>{let t;let r=a[0],l=a[1],i=l-r;t=i<=3e7?1e6:i<=5e7?2e6:i<=2e8?5e6:i<=1e9?1e7:2e7;let n=Math.ceil(i/t),d=[],c=new Set,x=new Set;e.forEach(e=>{let s=e.maker_fees,a=e.taker_fees;[...s,...a].forEach(s=>{s.volume>=r&&s.volume<=l&&(c.add(s.volume),x.add(`${s.volume}-${e.exchange}`))})});let m=new Set([0]);r>0&&m.add(r);for(let e=0;e<=n;e++){let s=r+e*t;if(s>l)break;m.add(s)}m.add(l);let u=l+.05*l;m.add(u);let h=l+.1*l;m.add(h),c.forEach(e=>m.add(e));let f=Array.from(m).sort((e,s)=>e-s);return f.forEach(a=>{let t={volume:a};e.forEach(e=>{let r="maker"===s?e.maker_fees:e.taker_fees,l=o(r,a);if(null===l&&r.length>0){let e=r[r.length-1];l=e.fee}null===l&&(l=0),t[e.exchange]=l,x.has(`${a}-${e.exchange}`)&&(t[`${e.exchange}_isStep`]=1)}),d.push(t)}),{chartData:d,stepMarkers:[]}},[e,s,a]);h(a[0],a[1],i);let E=function(e,s){let a=Math.floor(e),t=Math.ceil(s),r=[];for(let e=a;e<=t;e+=1)r.push(e);return r}(l[0],l[1]),R=e=>{let{cx:s,cy:a,payload:r,dataKey:l}=e;return r&&r[`${l}_isStep`]?t.jsx("circle",{cx:s,cy:a,r:3,fill:f[l]||"#6b7280",stroke:"#ffffff",strokeWidth:1}):null},$=(0,r.useCallback)(e=>{if(D(!0),e&&void 0!==e.activeLabel){let s=e.activeLabel,t=a[1];t<=3e7&&s<3e7?d(5e5*Math.round(s/5e5)):d(s)}},[d]),z=(0,r.useCallback)(()=>{D(!1),d(null)},[d]),P=(0,r.useCallback)(e=>{if(e&&void 0!==e.startIndex&&void 0!==e.endIndex){let s=M[e.startIndex]?.volume,a=M[e.endIndex]?.volume;void 0!==s&&void 0!==a&&C([s,a])}else C(null)},[M]),B=w||a,A=(0,r.useMemo)(()=>h(B[0],B[1],i),[B,i]);return t.jsx("div",{className:"h-[600px] w-full relative",children:t.jsx(p.h,{width:"100%",height:"100%",children:(0,t.jsxs)(g.w,{data:M,margin:{top:20,right:30,left:30,bottom:100},onMouseMove:$,onMouseLeave:z,children:[t.jsx(j.q,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),t.jsx(v.K,{dataKey:"volume",scale:i?"log":"linear",domain:i?[1,B[1]]:[0,B[1]],ticks:A,tickFormatter:x,stroke:"#6b7280",fontSize:12,orientation:"bottom",axisLine:!1,tickLine:{stroke:"#6b7280"},type:"number",padding:{left:0,right:0}}),t.jsx(y.Q,{domain:l,ticks:E,tickFormatter:m,stroke:"#6b7280",fontSize:12,axisLine:{stroke:"#374151",strokeWidth:2},tickLine:{stroke:"#6b7280",strokeWidth:1},tick:{fontSize:12,fill:"#6b7280"}}),t.jsx(b.u,{content:t.jsx(({active:a,payload:r,label:l})=>{if(!a||!r||!r.length)return null;let i=[...r].sort((e,s)=>e.value-s.value);return(0,t.jsxs)("div",{className:"bg-white border rounded-lg shadow-lg p-3 text-sm",children:[(0,t.jsxs)("p",{className:"font-medium mb-2",children:["Volume: ",x(l)]}),i.map((a,r)=>{let i=e.find(e=>e.exchange===a.dataKey),n=i?"maker"===s?i.maker_fees:i.taker_fees:[],d=c(n,l);return(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:a.color}}),(0,t.jsxs)("span",{className:"font-medium",children:[a.dataKey,":"]}),t.jsx("span",{children:m(a.value)}),(0,t.jsxs)("span",{className:"text-gray-500 text-xs",children:["(",u(d),")"]}),a.value<0&&t.jsx("span",{className:"bg-green-100 text-green-800 px-2 py-0.5 rounded text-xs font-medium",children:"Rebate"})]},r)})]})},{})}),t.jsx(N.d,{y:0,stroke:"#374151",strokeWidth:2}),t.jsx(N.d,{y:0,stroke:"#374151",strokeWidth:2,strokeDasharray:"0"}),(0,t.jsxs)("g",{children:[t.jsx("line",{x1:30,y1:0,x2:40,y2:0,stroke:"#374151",strokeWidth:2,transform:"translate(0, 0)"}),t.jsx("line",{x1:-10,y1:0,x2:0,y2:0,stroke:"#374151",strokeWidth:2,transform:"translate(0, 0)"})]}),n&&t.jsx(N.d,{x:n,stroke:"#ef4444",strokeWidth:1}),e.map(e=>t.jsx(k.x,{type:"stepAfter",dataKey:e.exchange,stroke:f[e.exchange]||"#6b7280",strokeWidth:"Nado"===e.exchange&&_?4:"Nado"===e.exchange?3:2,strokeDasharray:"Nado"===e.exchange&&_?"8 4":void 0,filter:"Nado"===e.exchange&&_?"url(#glow)":void 0,dot:t.jsx(R,{}),connectNulls:!0,isAnimationActive:!1},e.exchange)),t.jsx("defs",{children:(0,t.jsxs)("filter",{id:"glow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:[t.jsx("feGaussianBlur",{stdDeviation:"3",result:"coloredBlur"}),(0,t.jsxs)("feMerge",{children:[t.jsx("feMergeNode",{in:"coloredBlur"}),t.jsx("feMergeNode",{in:"SourceGraphic"})]})]})}),t.jsx(F.B,{dataKey:"volume",height:35,stroke:"#3b82f6",fill:"#eff6ff",tickFormatter:x,y:520,onChange:P})]})})})}var C=a(1085),_=a(1971),D=a(566),M=a(8126);function S(...e){return(0,M.m6)((0,D.W)(e))}let E=(0,_.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),R=r.forwardRef(({className:e,variant:s,size:a,asChild:r=!1,...l},i)=>{let n=r?C.g7:"button";return t.jsx(n,{className:S(E({variant:s,size:a,className:e})),ref:i,...l})});R.displayName="Button";var $=a(8856),z=a(1264);let P=r.forwardRef(({className:e,...s},a)=>t.jsx($.fC,{ref:a,className:S("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...s,children:t.jsx($.z$,{className:S("flex items-center justify-center text-current"),children:t.jsx(z.Z,{className:"h-4 w-4"})})}));P.displayName=$.fC.displayName;let B=r.forwardRef(({className:e,...s},a)=>t.jsx("div",{ref:a,className:S("rounded-lg border bg-card text-card-foreground shadow-sm",e),...s}));B.displayName="Card";let A=r.forwardRef(({className:e,...s},a)=>t.jsx("div",{ref:a,className:S("flex flex-col space-y-1.5 p-6",e),...s}));A.displayName="CardHeader";let V=r.forwardRef(({className:e,...s},a)=>t.jsx("h3",{ref:a,className:S("text-2xl font-semibold leading-none tracking-tight",e),...s}));V.displayName="CardTitle";let X=r.forwardRef(({className:e,...s},a)=>t.jsx("p",{ref:a,className:S("text-sm text-muted-foreground",e),...s}));X.displayName="CardDescription";let T=r.forwardRef(({className:e,...s},a)=>t.jsx("div",{ref:a,className:S("p-6 pt-0",e),...s}));T.displayName="CardContent";let q=r.forwardRef(({className:e,...s},a)=>t.jsx("div",{ref:a,className:S("flex items-center p-6 pt-0",e),...s}));function L({exchanges:e,originalExchanges:s,selectedExchanges:a,onSelectionChange:r}){let l=e.filter(e=>"CEX"===e.type&&"perp"===e.product),i=e.filter(e=>"DEX"===e.type&&"perp"===e.product),n=e.filter(e=>"Nado"===e.type&&"perp"===e.product),d=s.filter(e=>"CEX"===e.type&&"perp"===e.product),o=s.filter(e=>"DEX"===e.type&&"perp"===e.product),c=s.filter(e=>"Nado"===e.type&&"perp"===e.product),x=(e,s)=>{s?r([...a,e]):r(a.filter(s=>s!==e))},m=(s,t)=>{let l=e.filter(e=>e.type===s).map(e=>e.exchange);if(t){let e=[...new Set([...a,...l])];r(e)}else{let e=a.filter(e=>!l.includes(e));r(e)}};return(0,t.jsxs)(B,{children:[(0,t.jsxs)(A,{className:"pb-3",children:[t.jsx(V,{className:"text-lg",children:"Exchange Selection"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[t.jsx(R,{variant:"outline",size:"sm",onClick:()=>{r(e.map(e=>e.exchange))},children:"All"}),t.jsx(R,{variant:"outline",size:"sm",onClick:()=>{r([])},children:"None"})]})]}),(0,t.jsxs)(T,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[t.jsx("div",{className:"flex items-center justify-between",children:t.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Quick Select"})}),(0,t.jsxs)("div",{className:"flex gap-2",children:[t.jsx(R,{variant:l.every(e=>a.includes(e.exchange))?"default":"outline",size:"sm",onClick:()=>m("CEX",!l.every(e=>a.includes(e.exchange))),children:"CEX"}),t.jsx(R,{variant:i.every(e=>a.includes(e.exchange))?"default":"outline",size:"sm",onClick:()=>m("DEX",!i.every(e=>a.includes(e.exchange))),children:"DEX"}),t.jsx(R,{variant:n.every(e=>a.includes(e.exchange))?"default":"outline",size:"sm",onClick:()=>m("Nado",!n.every(e=>a.includes(e.exchange))),children:"Nado"})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[t.jsx("h4",{className:"text-sm font-medium text-gray-700",children:"Centralized Exchanges"}),t.jsx("div",{className:"space-y-2",children:l.map(e=>{let s=d.find(s=>s.exchange===e.exchange);return(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[t.jsx(P,{id:`cex-${e.exchange}`,checked:a.includes(e.exchange),onCheckedChange:s=>x(e.exchange,s)}),(0,t.jsxs)("label",{htmlFor:`cex-${e.exchange}`,className:"text-sm cursor-pointer",children:[e.exchange," ",(0,t.jsxs)("span",{className:"text-gray-500",children:["(",s?.day_basis||e.day_basis,"D)"]})]})]},e.exchange)})})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[t.jsx("h4",{className:"text-sm font-medium text-gray-700",children:"Decentralized Exchanges"}),t.jsx("div",{className:"space-y-2",children:i.map(e=>{let s=o.find(s=>s.exchange===e.exchange);return(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[t.jsx(P,{id:`dex-${e.exchange}`,checked:a.includes(e.exchange),onCheckedChange:s=>x(e.exchange,s)}),(0,t.jsxs)("label",{htmlFor:`dex-${e.exchange}`,className:"text-sm cursor-pointer",children:[e.exchange," ",(0,t.jsxs)("span",{className:"text-gray-500",children:["(",s?.day_basis||e.day_basis,"D)"]})]})]},e.exchange)})})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[t.jsx("h4",{className:"text-sm font-medium text-gray-700",children:"Nado"}),t.jsx("div",{className:"space-y-2",children:n.map(e=>{let s=c.find(s=>s.exchange===e.exchange);return(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[t.jsx(P,{id:`nado-${e.exchange}`,checked:a.includes(e.exchange),onCheckedChange:s=>x(e.exchange,s)}),(0,t.jsxs)("label",{htmlFor:`nado-${e.exchange}`,className:"text-sm cursor-pointer",children:[e.exchange," ",(0,t.jsxs)("span",{className:"text-gray-500",children:["(",s?.day_basis||e.day_basis,"D)"]})]})]},e.exchange)})})]})]})]})}q.displayName="CardFooter";let Z=(0,_.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function K({className:e,variant:s,...a}){return t.jsx("div",{className:S(Z({variant:s}),e),...a})}var I=a(5371);let W=I.fC,G=r.forwardRef(({className:e,...s},a)=>t.jsx(I.aV,{ref:a,className:S("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...s}));G.displayName=I.aV.displayName;let U=r.forwardRef(({className:e,...s},a)=>t.jsx(I.xz,{ref:a,className:S("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...s}));U.displayName=I.xz.displayName;let O=r.forwardRef(({className:e,...s},a)=>t.jsx(I.VY,{ref:a,className:S("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...s}));function H({rankings:e,hoverVolume:s,chartColors:a}){let r=({data:e,sortBy:s})=>t.jsx("div",{className:"space-y-2",children:e.map((e,r)=>(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg border bg-gray-50",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:a[e.exchange]||"#6b7280"}}),t.jsx("span",{className:"font-medium text-sm",children:e.exchange})]}),t.jsx(K,{variant:"secondary",className:"text-xs",children:e.type})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3 text-sm",children:[(0,t.jsxs)("div",{className:"text-right",children:[t.jsx("div",{className:"text-xs text-gray-500",children:"Maker"}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[t.jsx("span",{className:"maker"===s?"font-bold":"",children:m(e.makerFee)}),void 0!==e.makerCumulativeFees&&(0,t.jsxs)("span",{className:"text-gray-500 text-xs",children:["(",u(e.makerCumulativeFees),")"]}),e.makerFee<0&&t.jsx(K,{variant:"outline",className:"text-xs bg-green-50 text-green-700 border-green-200",children:"Rebate"})]})]}),(0,t.jsxs)("div",{className:"text-right",children:[t.jsx("div",{className:"text-xs text-gray-500",children:"Taker"}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[t.jsx("span",{className:"taker"===s?"font-bold":"",children:m(e.takerFee)}),void 0!==e.takerCumulativeFees&&(0,t.jsxs)("span",{className:"text-gray-500 text-xs",children:["(",u(e.takerCumulativeFees),")"]})]})]})]})]},`${e.exchange}-${r}`))});return(0,t.jsxs)(B,{children:[t.jsx(A,{className:"pb-3",children:(0,t.jsxs)(V,{className:"text-lg",children:["Rankings at ",x(s)]})}),t.jsx(T,{children:(0,t.jsxs)(W,{defaultValue:"maker",className:"w-full",children:[(0,t.jsxs)(G,{className:"grid w-full grid-cols-2",children:[t.jsx(U,{value:"maker",children:"Maker Fees"}),t.jsx(U,{value:"taker",children:"Taker Fees"})]}),t.jsx(O,{value:"maker",className:"mt-4",children:t.jsx(r,{data:e.maker,sortBy:"maker"})}),t.jsx(O,{value:"taker",className:"mt-4",children:t.jsx(r,{data:e.taker,sortBy:"taker"})})]})})]})}O.displayName=I.VY.displayName;var J=a(3618);let Y=(0,_.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Q=r.forwardRef(({className:e,...s},a)=>t.jsx(J.f,{ref:a,className:S(Y(),e),...s}));function ee({dayBasis:e,onDayBasisChange:s,isLogScale:a,onLogScaleChange:r}){return(0,t.jsxs)(B,{children:[t.jsx(A,{className:"pb-3",children:t.jsx(V,{className:"text-lg",children:"Chart Settings"})}),t.jsx(T,{className:"space-y-4",children:(0,t.jsxs)("div",{className:"space-y-3",children:[t.jsx(Q,{className:"text-sm font-medium text-gray-700",children:"Volume Period Normalization"}),t.jsx("div",{className:"flex gap-1",children:[7,14,30].map(a=>(0,t.jsxs)(R,{variant:e===a?"default":"outline",size:"sm",onClick:()=>s(a),className:"flex-1",children:[a,"D"]},a))}),(0,t.jsxs)("p",{className:"text-xs text-gray-500",children:["Normalizes all volume thresholds to ",e,"-day basis using simple multipliers"]}),(0,t.jsxs)("div",{className:"text-xs text-gray-500 space-y-1",children:[t.jsx("p",{children:"• 7D → 14D: \xd72 | 7D → 30D: \xd74"}),t.jsx("p",{children:"• 14D → 7D: \xf72 | 14D → 30D: \xd72"}),t.jsx("p",{children:"• 30D → 7D: \xf74 | 30D → 14D: \xf72"})]}),(0,t.jsxs)("div",{className:"mt-3 p-4 bg-blue-50 rounded border border-blue-200",children:[t.jsx("p",{className:"text-xs text-blue-800 font-medium mb-1",children:"\uD83D\uDCA1 Cumulative Fees"}),t.jsx("p",{className:"text-xs text-blue-700",children:"Hover over charts to see total fees paid to reach each volume threshold. Numbers in brackets show cumulative fees (area under the fee curve)."})]})]})})]})}Q.displayName=J.f.displayName;let es=r.forwardRef(({className:e,type:s,...a},r)=>t.jsx("input",{type:s,className:S("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:r,...a}));es.displayName="Input";var ea=a(5030),et=a(9458),er=a(4678);let el=ea.fC;ea.ZA;let ei=ea.B4,en=r.forwardRef(({className:e,children:s,...a},r)=>(0,t.jsxs)(ea.xz,{ref:r,className:S("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...a,children:[s,t.jsx(ea.JO,{asChild:!0,children:t.jsx(et.Z,{className:"h-4 w-4 opacity-50"})})]}));en.displayName=ea.xz.displayName;let ed=r.forwardRef(({className:e,...s},a)=>t.jsx(ea.u_,{ref:a,className:S("flex cursor-default items-center justify-center py-1",e),...s,children:t.jsx(er.Z,{className:"h-4 w-4"})}));ed.displayName=ea.u_.displayName;let eo=r.forwardRef(({className:e,...s},a)=>t.jsx(ea.$G,{ref:a,className:S("flex cursor-default items-center justify-center py-1",e),...s,children:t.jsx(et.Z,{className:"h-4 w-4"})}));eo.displayName=ea.$G.displayName;let ec=r.forwardRef(({className:e,children:s,position:a="popper",...r},l)=>t.jsx(ea.h_,{children:(0,t.jsxs)(ea.VY,{ref:l,className:S("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===a&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:a,...r,children:[t.jsx(ed,{}),t.jsx(ea.l_,{className:S("p-1","popper"===a&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),t.jsx(eo,{})]})}));ec.displayName=ea.VY.displayName;let ex=r.forwardRef(({className:e,...s},a)=>t.jsx(ea.__,{ref:a,className:S("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...s}));ex.displayName=ea.__.displayName;let em=r.forwardRef(({className:e,children:s,...a},r)=>(0,t.jsxs)(ea.ck,{ref:r,className:S("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...a,children:[t.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:t.jsx(ea.wU,{children:t.jsx(z.Z,{className:"h-4 w-4"})})}),t.jsx(ea.eT,{children:s})]}));em.displayName=ea.ck.displayName;let eu=r.forwardRef(({className:e,...s},a)=>t.jsx(ea.Z0,{ref:a,className:S("-mx-1 my-1 h-px bg-muted",e),...s}));eu.displayName=ea.Z0.displayName;var eh=a(1063),ef=a(2995),ep=a(2385),eg=a(6303);function ej({nadoData:e,onSave:s}){let[a,l]=(0,r.useState)(!1),[i,n]=(0,r.useState)(e.day_basis),[d,o]=(0,r.useState)(!1),[c,x]=(0,r.useState)(null),[m,u]=(0,r.useState)(()=>e.maker_fees.map((s,a)=>({volume:s.volume,makerFee:s.fee,takerFee:e.taker_fees[a]?.fee||0}))),h=async()=>{o(!0),x(null);try{let a={...e,day_basis:i,maker_fees:m.map(e=>({volume:e.volume,fee:e.makerFee})),taker_fees:m.map(e=>({volume:e.volume,fee:e.takerFee}))};await s(a),x({type:"success",text:"Nado fees updated successfully! Changes are now saved to the dataset."}),l(!1),setTimeout(()=>x(null),3e3)}catch(e){x({type:"error",text:"Failed to save changes. Please try again."})}finally{o(!1)}},f=(e,s,a)=>{u(t=>t.map((t,r)=>r===e?{...t,[s]:a}:t))},p=e=>{m.length>1&&u(s=>s.filter((s,a)=>a!==e))},g=e=>e>=1e3?`$${(e/1e3).toFixed(1)}B`:`$${e.toFixed(0)}M`;return a?(0,t.jsxs)(B,{className:"mb-6",children:[(0,t.jsxs)(A,{className:"pb-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[t.jsx(V,{className:"text-lg",children:"Edit Nado Fee Configuration"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(R,{onClick:()=>{n(e.day_basis),u(e.maker_fees.map((s,a)=>({volume:s.volume,makerFee:s.fee,takerFee:e.taker_fees[a]?.fee||0})))},variant:"outline",size:"sm",children:[t.jsx(eh.Z,{className:"h-4 w-4 mr-1"}),"Reset"]}),(0,t.jsxs)(R,{onClick:h,size:"sm",disabled:d,children:[t.jsx(ef.Z,{className:"h-4 w-4 mr-1"}),d?"Saving...":"Save"]}),t.jsx(R,{onClick:()=>l(!1),variant:"outline",size:"sm",children:"Cancel"})]})]}),c&&t.jsx("div",{className:`mt-3 p-3 rounded text-sm ${"success"===c.type?"bg-green-50 text-green-800 border border-green-200":"bg-red-50 text-red-800 border border-red-200"}`,children:c.text})]}),(0,t.jsxs)(T,{children:[(0,t.jsxs)("div",{className:"mb-4",children:[t.jsx(Q,{htmlFor:"day-basis",className:"text-sm font-medium",children:"Rolling Period"}),(0,t.jsxs)(el,{value:i.toString(),onValueChange:e=>n(parseInt(e)),children:[t.jsx(en,{className:"w-32 mt-1",children:t.jsx(ei,{})}),(0,t.jsxs)(ec,{children:[t.jsx(em,{value:"7",children:"7 days"}),t.jsx(em,{value:"14",children:"14 days"}),t.jsx(em,{value:"30",children:"30 days"})]})]})]}),(0,t.jsxs)("div",{className:"overflow-x-auto",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[t.jsx("h4",{className:"text-sm font-medium text-gray-700",children:"Fee Schedule"}),(0,t.jsxs)(R,{onClick:()=>{let e=m[m.length-1],s=e?e.volume+1e3:1e3;u(e=>[...e,{volume:s,makerFee:0,takerFee:2.5}])},variant:"outline",size:"sm",children:[t.jsx(ep.Z,{className:"h-4 w-4 mr-1"}),"Add Tier"]})]}),(0,t.jsxs)("table",{className:"w-full text-sm",children:[t.jsx("thead",{children:(0,t.jsxs)("tr",{className:"border-b",children:[t.jsx("th",{className:"text-left py-2 px-3",children:"Volume Threshold"}),t.jsx("th",{className:"text-left py-2 px-3",children:"Taker Fee (bps)"}),t.jsx("th",{className:"text-left py-2 px-3",children:"Maker Fee (bps)"}),t.jsx("th",{className:"text-left py-2 px-3",children:"Actions"})]})}),t.jsx("tbody",{children:m.map((e,s)=>(0,t.jsxs)("tr",{className:"border-b",children:[t.jsx("td",{className:"py-2 px-3",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-xs text-gray-500",children:"$"}),t.jsx(es,{type:"number",value:e.volume,onChange:e=>f(s,"volume",parseFloat(e.target.value)||0),className:"w-24 h-8 text-xs",min:"0",step:"1"}),t.jsx("span",{className:"text-xs text-gray-500",children:"M"})]})}),t.jsx("td",{className:"py-2 px-3",children:t.jsx(es,{type:"number",value:e.takerFee,onChange:e=>f(s,"takerFee",parseFloat(e.target.value)||0),className:"w-20 h-8 text-xs",step:"0.1"})}),t.jsx("td",{className:"py-2 px-3",children:t.jsx(es,{type:"number",value:e.makerFee,onChange:e=>f(s,"makerFee",parseFloat(e.target.value)||0),className:"w-20 h-8 text-xs",step:"0.1"})}),t.jsx("td",{className:"py-2 px-3",children:t.jsx(R,{onClick:()=>p(s),variant:"ghost",size:"sm",disabled:1===m.length,className:"h-8 w-8 p-0 text-red-500 hover:text-red-700 hover:bg-red-50",children:t.jsx(eg.Z,{className:"h-4 w-4"})})})]},s))})]})]}),(0,t.jsxs)("div",{className:"mt-4 text-xs text-gray-500",children:[t.jsx("p",{children:"• Volume thresholds are in millions USD (e.g., 5 = $5M)"}),t.jsx("p",{children:"• Fees are in basis points (e.g., 1.5 = 1.5 bps = 0.015%)"}),t.jsx("p",{children:"• Rolling period determines the volume calculation timeframe"}),t.jsx("p",{children:"• Add tiers to create more granular fee structures"}),t.jsx("p",{children:"• Changes will update the chart immediately after saving"})]})]})]}):(0,t.jsxs)(B,{className:"mb-6",children:[t.jsx(A,{className:"pb-3",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[t.jsx(V,{className:"text-lg",children:"Nado Fee Configuration"}),(0,t.jsxs)("div",{className:"text-sm text-gray-600",children:["Rolling Period: ",e.day_basis," days"]}),t.jsx(R,{onClick:()=>l(!0),variant:"outline",size:"sm",children:"Edit Fees"})]})}),(0,t.jsxs)(T,{children:[c&&"success"===c.type&&t.jsx("div",{className:"mb-4 p-3 bg-green-50 text-green-800 border border-green-200 rounded text-sm",children:c.text}),t.jsx("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full text-sm",children:[t.jsx("thead",{children:(0,t.jsxs)("tr",{className:"border-b",children:[t.jsx("th",{className:"text-left py-2 px-3",children:"Volume Threshold"}),t.jsx("th",{className:"text-left py-2 px-3",children:"Taker Fee (bps)"}),t.jsx("th",{className:"text-left py-2 px-3",children:"Maker Fee (bps)"})]})}),t.jsx("tbody",{children:m.map((e,s)=>(0,t.jsxs)("tr",{className:"border-b",children:[t.jsx("td",{className:"py-2 px-3 font-medium",children:g(e.volume)}),t.jsx("td",{className:"py-2 px-3",children:e.takerFee.toFixed(1)}),t.jsx("td",{className:"py-2 px-3",children:e.makerFee.toFixed(1)})]},s))})]})})]})]})}function ev({initialData:e}){let s=(0,l.useSearchParams)(),a=(0,l.useRouter)(),[i,n]=(0,r.useState)(e),[d,x]=(0,r.useState)(()=>{let e=s.get("exchanges");return e?e.split(","):["Nado"]}),[m,u]=(0,r.useState)(()=>{let e=s.get("dayBasis");return e?parseInt(e):14}),[h,p]=(0,r.useState)(!1),[g,j]=(0,r.useState)(2e9),v=async e=>{try{let s={...i,exchanges:i.exchanges.map(s=>"Nado"===s.exchange?e:s)};n(s);let a=await fetch("/api/update-dataset",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!a.ok)throw Error("Failed to save dataset");console.log("Nado data updated successfully")}catch(e){console.error("Error updating Nado data:",e)}};(0,r.useEffect)(()=>{let e=new URLSearchParams;d.length>0&&e.set("exchanges",d.join(",")),14!==m&&e.set("dayBasis",m.toString());let s=e.toString()?`?${e.toString()}`:"";s?a.replace(s):a.replace(window.location.pathname)},[d,m,a]);let y=(0,r.useMemo)(()=>i.exchanges.filter(e=>"perp"===e.product).map(e=>{let s;return e.day_basis===m?e:(s=7===e.day_basis&&14===m?2:7===e.day_basis&&30===m?4:14===e.day_basis&&7===m?.5:14===e.day_basis&&30===m?2:30===e.day_basis&&7===m?.25:30===e.day_basis&&14===m?.5:m/e.day_basis,{...e,day_basis:m,maker_fees:e.maker_fees.map(e=>({...e,volume:e.volume*s})),taker_fees:e.taker_fees.map(e=>({...e,volume:e.volume*s}))})}),[i,m]),b=(0,r.useMemo)(()=>y.filter(e=>d.includes(e.exchange)),[y,d]),{volumeDomain:N,makerFeeDomain:k,takerFeeDomain:F}=(0,r.useMemo)(()=>{if(0===b.length)return{volumeDomain:[0,1e7],makerFeeDomain:[-5,10],takerFeeDomain:[0,10]};let e=1/0,s=0,a=1/0,t=-1/0,r=1/0,l=-1/0;b.forEach(i=>{i.maker_fees.forEach(r=>{e=Math.min(e,r.volume),s=Math.max(s,r.volume),a=Math.min(a,r.fee),t=Math.max(t,r.fee)}),i.taker_fees.forEach(a=>{e=Math.min(e,a.volume),s=Math.max(s,a.volume),r=Math.min(r,a.fee),l=Math.max(l,a.fee)})});let i=(s-e)*.1,n=Math.max(1,(t-a)*.3),d=Math.max(1,(l-r)*.3);return{volumeDomain:[0,s+i],makerFeeDomain:[Math.min(a-n,-3),t+n],takerFeeDomain:[Math.min(r-d,-1),l+d]}},[b]),C=(0,r.useMemo)(()=>{if(!g||0===b.length)return{maker:[],taker:[]};let e=b.map(e=>({exchange:e.exchange,type:e.type,makerFee:o(e.maker_fees,g),takerFee:o(e.taker_fees,g),makerCumulativeFees:c(e.maker_fees,g),takerCumulativeFees:c(e.taker_fees,g)})).sort((e,s)=>e.makerFee!==s.makerFee?e.makerFee-s.makerFee:e.takerFee!==s.takerFee?e.takerFee-s.takerFee:e.exchange.localeCompare(s.exchange)),s=[...e].sort((e,s)=>e.takerFee!==s.takerFee?e.takerFee-s.takerFee:e.makerFee!==s.makerFee?e.makerFee-s.makerFee:e.exchange.localeCompare(s.exchange));return{maker:e,taker:s}},[b,g]),_=e=>{if(null===e){j(null);return}j(e)},D=i.exchanges.find(e=>"Nado"===e.exchange);return(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[(0,t.jsxs)("div",{className:"lg:col-span-1 space-y-6",children:[t.jsx(L,{exchanges:y,originalExchanges:i.exchanges.filter(e=>"perp"===e.product),selectedExchanges:d,onSelectionChange:x}),t.jsx(ee,{dayBasis:m,onDayBasisChange:u,isLogScale:h,onLogScaleChange:p})]}),(0,t.jsxs)("div",{className:"lg:col-span-3 space-y-6",children:[D&&t.jsx(ej,{nadoData:D,onSave:v}),b.length>0&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"bg-white rounded-lg border shadow-sm p-6",children:[t.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Taker Fees (bps)"}),t.jsx(w,{exchanges:b,feeType:"taker",volumeDomain:N,feeDomain:F,isLogScale:h,hoverVolume:g,onHoverChange:_,colors:f})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg border shadow-sm p-6",children:[t.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Maker Fees (bps)"}),t.jsx(w,{exchanges:b,feeType:"maker",volumeDomain:N,feeDomain:k,isLogScale:h,hoverVolume:g,onHoverChange:_,colors:f})]})]}),g&&b.length>0&&t.jsx(H,{rankings:C,hoverVolume:g,chartColors:f})]})]})}},4267:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>f,dynamic:()=>u,revalidate:()=>h});var t=a(8144),r=a(7536);let l=(0,r.createProxy)(String.raw`/Users/ivesluo/Desktop/perp_fees/components/fee-visualization.tsx`),{__esModule:i,$$typeof:n}=l,d=l.default;var o=a(4471),c=a(7147),x=a(1017),m=a.n(x);let u="force-dynamic",h=0;async function f(){let e=m().join(process.cwd(),"public","dataset.json"),s=await c.promises.readFile(e,"utf-8"),a=JSON.parse(s),r=(0,o.KE)(a);return t.jsx("div",{className:"min-h-screen bg-gray-50",children:(0,t.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,t.jsxs)("div",{className:"mb-8",children:[t.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-2",children:"Perpetual Futures Fee Comparison"}),t.jsx("p",{className:"text-lg text-gray-600",children:"Interactive comparison of maker and taker fees across major centralized and decentralized exchanges"})]}),t.jsx(d,{initialData:r})]})})}}};var s=require("../webpack-runtime.js");s.C(e);var a=e=>s(s.s=e),t=s.X(0,[255,308,640,471,679],()=>a(4940));module.exports=t})();