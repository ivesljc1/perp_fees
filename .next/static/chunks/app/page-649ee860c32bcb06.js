(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{8972:function(e,a,s){Promise.resolve().then(s.bind(s,7958))},7958:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return ej}});var t=s(7437),r=s(2265),l=s(4033),n=s(6418);let i=n.Ry({volume:n.Rx().min(0),fee:n.Rx()}),d=n.Ry({exchange:n.Z_().min(1),type:n.Km(["CEX","DEX","Nado"]),product:n.Km(["perp","spot"]),day_basis:n.Rx().int().positive(),maker_fees:n.IX(i).min(1),taker_fees:n.IX(i).min(1)});function c(e,a){var s,t;let r=null!==(t=null===(s=e[0])||void 0===s?void 0:s.fee)&&void 0!==t?t:0;for(let s of e)if(a>=s.volume)r=s.fee;else break;return r}function o(e,a){if(a<=0)return 0;let s=0;for(let t=0;t<e.length;t++){let r=e[t],l=e[t+1];if(a<r.volume)continue;let n=r.volume,i=l?Math.min(a,l.volume):a;if(i>n){let e=(i-n)*1e6,a=r.fee/1e4,t=e*a;s+=t}}return s}function m(e){return e>=1e3?"$".concat((e/1e3).toFixed(1),"B"):e>=1?"$".concat(e.toFixed(1),"M"):"$".concat((1e3*e).toFixed(0),"K")}function x(e){return"".concat(e>=0?"+":"").concat(e.toFixed(1),"bps")}function u(e){return"$".concat(e.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0}))}function h(e,a,s){if(s){let e=Math.floor(Math.log10(1)),s=Math.ceil(Math.log10(a)),t=[];for(let r=e;r<=s;r++){let e=Math.pow(10,r);t.push(e),5*e<=a&&t.push(5*e)}return t.filter(e=>e>=1&&e<=a)}{let s;let t=a-e;s=t<=20?5:t<=100?10:t<=500?50:t<=2e3?100:t<=5e3?500:1e3;let r=Math.max(0,Math.floor(e/s)*s),l=Math.ceil(a/s)*s,n=[];for(let t=r;t<=l;t+=s)t>=e&&t<=a&&n.push(t);if(n.length<3){let t=s/2,n=[];for(let s=r;s<=l;s+=t)s>=e&&s<=a&&n.push(s);return n}return n}}n.Ry({exchanges:n.IX(d).min(1)});let f={Binance:"#F0B90B",Bybit:"#F7931A",Kraken:"#5C4B99",OKX:"#0066CC",Coinbase:"#0052FF",Hyperliquid:"#00D2FF",EdgeX:"#FF6B35",Jupiter:"#C147E9",Drift:"#9945FF","ApeX Protocol":"#00FFB3",Aster:"#FF4081",GMX:"#4DABF7",Vertex:"#7C3AED",ParaDex:"#10B981",Nado:"#FF1744"};var p=s(5253),g=s(173),v=s(6573),j=s(4235),y=s(5864),b=s(4070),N=s(7978),k=s(6910),F=s(4700);function w(e){let{exchanges:a,feeType:s,volumeDomain:l,feeDomain:n,isLogScale:i,hoverVolume:d,onHoverChange:f,colors:w}=e,[C,_]=(0,r.useState)(null),[D,M]=(0,r.useState)(!1),{chartData:S,stepMarkers:R}=(0,r.useMemo)(()=>{let e;let t=l[0],r=l[1],n=r-t;e=n<=3e7?1e6:n<=5e7?2e6:n<=2e8?5e6:n<=1e9?1e7:2e7;let i=Math.ceil(n/e),d=[],o=new Set,m=new Set;a.forEach(e=>{let a=e.maker_fees,s=e.taker_fees;[...a,...s].forEach(a=>{a.volume>=t&&a.volume<=r&&(o.add(a.volume),m.add("".concat(a.volume,"-").concat(e.exchange)))})});let x=new Set([0]);t>0&&x.add(t);for(let a=0;a<=i;a++){let s=t+a*e;if(s>r)break;x.add(s)}x.add(r);let u=r+.05*r;x.add(u);let h=r+.1*r;x.add(h),o.forEach(e=>x.add(e));let f=Array.from(x).sort((e,a)=>e-a);return f.forEach(e=>{let t={volume:e};a.forEach(a=>{let r="maker"===s?a.maker_fees:a.taker_fees,l=c(r,e);if(null===l&&r.length>0){let e=r[r.length-1];l=e.fee}null===l&&(l=0),t[a.exchange]=l,m.has("".concat(e,"-").concat(a.exchange))&&(t["".concat(a.exchange,"_isStep")]=1)}),d.push(t)}),{chartData:d,stepMarkers:[]}},[a,s,l]);h(l[0],l[1],i);let E=function(e,a){let s=Math.floor(e),t=Math.ceil(a),r=[];for(let e=s;e<=t;e+=1)r.push(e);return r}(n[0],n[1]),z=e=>{let{cx:a,cy:s,payload:r,dataKey:l}=e;return r&&r["".concat(l,"_isStep")]?(0,t.jsx)("circle",{cx:a,cy:s,r:3,fill:w[l]||"#6b7280",stroke:"#ffffff",strokeWidth:1}):null},B=(0,r.useCallback)(e=>{if(M(!0),e&&void 0!==e.activeLabel){let a=e.activeLabel,s=l[1];s<=3e7&&a<3e7?f(5e5*Math.round(a/5e5)):f(a)}},[f]),V=(0,r.useCallback)(()=>{M(!1),f(null)},[f]),X=(0,r.useCallback)(e=>{if(e&&void 0!==e.startIndex&&void 0!==e.endIndex){var a,s;let t=null===(a=S[e.startIndex])||void 0===a?void 0:a.volume,r=null===(s=S[e.endIndex])||void 0===s?void 0:s.volume;void 0!==t&&void 0!==r&&_([t,r])}else _(null)},[S]),A=C||l,T=(0,r.useMemo)(()=>h(A[0],A[1],i),[A,i]);return(0,t.jsx)("div",{className:"h-[600px] w-full relative",children:(0,t.jsx)(p.h,{width:"100%",height:"100%",children:(0,t.jsxs)(g.w,{data:S,margin:{top:20,right:30,left:30,bottom:100},onMouseMove:B,onMouseLeave:V,children:[(0,t.jsx)(v.q,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),(0,t.jsx)(j.K,{dataKey:"volume",scale:i?"log":"linear",domain:i?[1,A[1]]:[0,A[1]],ticks:T,tickFormatter:m,stroke:"#6b7280",fontSize:12,orientation:"bottom",axisLine:!1,tickLine:{stroke:"#6b7280"},type:"number",padding:{left:0,right:0}}),(0,t.jsx)(y.Q,{domain:n,ticks:E,tickFormatter:x,stroke:"#6b7280",fontSize:12,axisLine:{stroke:"#374151",strokeWidth:2},tickLine:{stroke:"#6b7280",strokeWidth:1},tick:{fontSize:12,fill:"#6b7280"}}),(0,t.jsx)(b.u,{content:(0,t.jsx)(e=>{let{active:r,payload:l,label:n}=e;if(!r||!l||!l.length)return null;let i=[...l].sort((e,a)=>e.value-a.value);return(0,t.jsxs)("div",{className:"bg-white border rounded-lg shadow-lg p-3 text-sm",children:[(0,t.jsxs)("p",{className:"font-medium mb-2",children:["Volume: ",m(n)]}),i.map((e,r)=>{let l=a.find(a=>a.exchange===e.dataKey),i=l?"maker"===s?l.maker_fees:l.taker_fees:[],d=o(i,n);return(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:e.color}}),(0,t.jsxs)("span",{className:"font-medium",children:[e.dataKey,":"]}),(0,t.jsx)("span",{children:x(e.value)}),(0,t.jsxs)("span",{className:"text-gray-500 text-xs",children:["(",u(d),")"]}),e.value<0&&(0,t.jsx)("span",{className:"bg-green-100 text-green-800 px-2 py-0.5 rounded text-xs font-medium",children:"Rebate"})]},r)})]})},{})}),(0,t.jsx)(N.d,{y:0,stroke:"#374151",strokeWidth:2}),(0,t.jsx)(N.d,{y:0,stroke:"#374151",strokeWidth:2,strokeDasharray:"0"}),(0,t.jsxs)("g",{children:[(0,t.jsx)("line",{x1:30,y1:0,x2:40,y2:0,stroke:"#374151",strokeWidth:2,transform:"translate(0, 0)"}),(0,t.jsx)("line",{x1:-10,y1:0,x2:0,y2:0,stroke:"#374151",strokeWidth:2,transform:"translate(0, 0)"})]}),d&&(0,t.jsx)(N.d,{x:d,stroke:"#ef4444",strokeWidth:1}),a.map(e=>(0,t.jsx)(k.x,{type:"stepAfter",dataKey:e.exchange,stroke:w[e.exchange]||"#6b7280",strokeWidth:"Nado"===e.exchange&&D?4:"Nado"===e.exchange?3:2,strokeDasharray:"Nado"===e.exchange&&D?"8 4":void 0,filter:"Nado"===e.exchange&&D?"url(#glow)":void 0,dot:(0,t.jsx)(z,{}),connectNulls:!0,isAnimationActive:!1},e.exchange)),(0,t.jsx)("defs",{children:(0,t.jsxs)("filter",{id:"glow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:[(0,t.jsx)("feGaussianBlur",{stdDeviation:"3",result:"coloredBlur"}),(0,t.jsxs)("feMerge",{children:[(0,t.jsx)("feMergeNode",{in:"coloredBlur"}),(0,t.jsx)("feMergeNode",{in:"SourceGraphic"})]})]})}),(0,t.jsx)(F.B,{dataKey:"volume",height:35,stroke:"#3b82f6",fill:"#eff6ff",tickFormatter:m,y:520,onChange:X})]})})})}var C=s(7256),_=s(6061),D=s(7042),M=s(4769);function S(){for(var e=arguments.length,a=Array(e),s=0;s<e;s++)a[s]=arguments[s];return(0,M.m6)((0,D.W)(a))}let R=(0,_.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),E=r.forwardRef((e,a)=>{let{className:s,variant:r,size:l,asChild:n=!1,...i}=e,d=n?C.g7:"button";return(0,t.jsx)(d,{className:S(R({variant:r,size:l,className:s})),ref:a,...i})});E.displayName="Button";var z=s(6062),B=s(2442);let V=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(z.fC,{ref:a,className:S("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",s),...r,children:(0,t.jsx)(z.z$,{className:S("flex items-center justify-center text-current"),children:(0,t.jsx)(B.Z,{className:"h-4 w-4"})})})});V.displayName=z.fC.displayName;let X=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)("div",{ref:a,className:S("rounded-lg border bg-card text-card-foreground shadow-sm",s),...r})});X.displayName="Card";let A=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)("div",{ref:a,className:S("flex flex-col space-y-1.5 p-6",s),...r})});A.displayName="CardHeader";let T=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)("h3",{ref:a,className:S("text-2xl font-semibold leading-none tracking-tight",s),...r})});T.displayName="CardTitle";let L=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)("p",{ref:a,className:S("text-sm text-muted-foreground",s),...r})});L.displayName="CardDescription";let Z=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)("div",{ref:a,className:S("p-6 pt-0",s),...r})});Z.displayName="CardContent";let K=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)("div",{ref:a,className:S("flex items-center p-6 pt-0",s),...r})});function $(e){let{exchanges:a,originalExchanges:s,selectedExchanges:r,onSelectionChange:l}=e,n=a.filter(e=>"CEX"===e.type&&"perp"===e.product),i=a.filter(e=>"DEX"===e.type&&"perp"===e.product),d=a.filter(e=>"Nado"===e.type&&"perp"===e.product),c=s.filter(e=>"CEX"===e.type&&"perp"===e.product),o=s.filter(e=>"DEX"===e.type&&"perp"===e.product),m=s.filter(e=>"Nado"===e.type&&"perp"===e.product),x=(e,a)=>{a?l([...r,e]):l(r.filter(a=>a!==e))},u=(e,s)=>{let t=a.filter(a=>a.type===e).map(e=>e.exchange);if(s){let e=[...new Set([...r,...t])];l(e)}else{let e=r.filter(e=>!t.includes(e));l(e)}};return(0,t.jsxs)(X,{children:[(0,t.jsxs)(A,{className:"pb-3",children:[(0,t.jsx)(T,{className:"text-lg",children:"Exchange Selection"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(E,{variant:"outline",size:"sm",onClick:()=>{l(a.map(e=>e.exchange))},children:"All"}),(0,t.jsx)(E,{variant:"outline",size:"sm",onClick:()=>{l([])},children:"None"})]})]}),(0,t.jsxs)(Z,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("div",{className:"flex items-center justify-between",children:(0,t.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Quick Select"})}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(E,{variant:n.every(e=>r.includes(e.exchange))?"default":"outline",size:"sm",onClick:()=>u("CEX",!n.every(e=>r.includes(e.exchange))),children:"CEX"}),(0,t.jsx)(E,{variant:i.every(e=>r.includes(e.exchange))?"default":"outline",size:"sm",onClick:()=>u("DEX",!i.every(e=>r.includes(e.exchange))),children:"DEX"}),(0,t.jsx)(E,{variant:d.every(e=>r.includes(e.exchange))?"default":"outline",size:"sm",onClick:()=>u("Nado",!d.every(e=>r.includes(e.exchange))),children:"Nado"})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("h4",{className:"text-sm font-medium text-gray-700",children:"Centralized Exchanges"}),(0,t.jsx)("div",{className:"space-y-2",children:n.map(e=>{let a=c.find(a=>a.exchange===e.exchange);return(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(V,{id:"cex-".concat(e.exchange),checked:r.includes(e.exchange),onCheckedChange:a=>x(e.exchange,a)}),(0,t.jsxs)("label",{htmlFor:"cex-".concat(e.exchange),className:"text-sm cursor-pointer",children:[e.exchange," ",(0,t.jsxs)("span",{className:"text-gray-500",children:["(",(null==a?void 0:a.day_basis)||e.day_basis,"D)"]})]})]},e.exchange)})})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("h4",{className:"text-sm font-medium text-gray-700",children:"Decentralized Exchanges"}),(0,t.jsx)("div",{className:"space-y-2",children:i.map(e=>{let a=o.find(a=>a.exchange===e.exchange);return(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(V,{id:"dex-".concat(e.exchange),checked:r.includes(e.exchange),onCheckedChange:a=>x(e.exchange,a)}),(0,t.jsxs)("label",{htmlFor:"dex-".concat(e.exchange),className:"text-sm cursor-pointer",children:[e.exchange," ",(0,t.jsxs)("span",{className:"text-gray-500",children:["(",(null==a?void 0:a.day_basis)||e.day_basis,"D)"]})]})]},e.exchange)})})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("h4",{className:"text-sm font-medium text-gray-700",children:"Nado"}),(0,t.jsx)("div",{className:"space-y-2",children:d.map(e=>{let a=m.find(a=>a.exchange===e.exchange);return(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(V,{id:"nado-".concat(e.exchange),checked:r.includes(e.exchange),onCheckedChange:a=>x(e.exchange,a)}),(0,t.jsxs)("label",{htmlFor:"nado-".concat(e.exchange),className:"text-sm cursor-pointer",children:[e.exchange," ",(0,t.jsxs)("span",{className:"text-gray-500",children:["(",(null==a?void 0:a.day_basis)||e.day_basis,"D)"]})]})]},e.exchange)})})]})]})]})}K.displayName="CardFooter";let I=(0,_.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function P(e){let{className:a,variant:s,...r}=e;return(0,t.jsx)("div",{className:S(I({variant:s}),a),...r})}var W=s(7094);let O=W.fC,G=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(W.aV,{ref:a,className:S("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",s),...r})});G.displayName=W.aV.displayName;let H=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(W.xz,{ref:a,className:S("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",s),...r})});H.displayName=W.xz.displayName;let U=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(W.VY,{ref:a,className:S("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...r})});function Y(e){let{rankings:a,hoverVolume:s,chartColors:r}=e,l=e=>{let{data:a,sortBy:s}=e;return(0,t.jsx)("div",{className:"space-y-2",children:a.map((e,a)=>(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg border bg-gray-50",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:r[e.exchange]||"#6b7280"}}),(0,t.jsx)("span",{className:"font-medium text-sm",children:e.exchange})]}),(0,t.jsx)(P,{variant:"secondary",className:"text-xs",children:e.type})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3 text-sm",children:[(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("div",{className:"text-xs text-gray-500",children:"Maker"}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)("span",{className:"maker"===s?"font-bold":"",children:x(e.makerFee)}),void 0!==e.makerCumulativeFees&&(0,t.jsxs)("span",{className:"text-gray-500 text-xs",children:["(",u(e.makerCumulativeFees),")"]}),e.makerFee<0&&(0,t.jsx)(P,{variant:"outline",className:"text-xs bg-green-50 text-green-700 border-green-200",children:"Rebate"})]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("div",{className:"text-xs text-gray-500",children:"Taker"}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)("span",{className:"taker"===s?"font-bold":"",children:x(e.takerFee)}),void 0!==e.takerCumulativeFees&&(0,t.jsxs)("span",{className:"text-gray-500 text-xs",children:["(",u(e.takerCumulativeFees),")"]})]})]})]})]},"".concat(e.exchange,"-").concat(a)))})};return(0,t.jsxs)(X,{children:[(0,t.jsx)(A,{className:"pb-3",children:(0,t.jsxs)(T,{className:"text-lg",children:["Rankings at ",m(s)]})}),(0,t.jsx)(Z,{children:(0,t.jsxs)(O,{defaultValue:"maker",className:"w-full",children:[(0,t.jsxs)(G,{className:"grid w-full grid-cols-2",children:[(0,t.jsx)(H,{value:"maker",children:"Maker Fees"}),(0,t.jsx)(H,{value:"taker",children:"Taker Fees"})]}),(0,t.jsx)(U,{value:"maker",className:"mt-4",children:(0,t.jsx)(l,{data:a.maker,sortBy:"maker"})}),(0,t.jsx)(U,{value:"taker",className:"mt-4",children:(0,t.jsx)(l,{data:a.taker,sortBy:"taker"})})]})})]})}U.displayName=W.VY.displayName;var J=s(6743);let q=(0,_.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Q=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(J.f,{ref:a,className:S(q(),s),...r})});function ee(e){let{dayBasis:a,onDayBasisChange:s,isLogScale:r,onLogScaleChange:l}=e;return(0,t.jsxs)(X,{children:[(0,t.jsx)(A,{className:"pb-3",children:(0,t.jsx)(T,{className:"text-lg",children:"Chart Settings"})}),(0,t.jsx)(Z,{className:"space-y-4",children:(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)(Q,{className:"text-sm font-medium text-gray-700",children:"Volume Period Normalization"}),(0,t.jsx)("div",{className:"flex gap-1",children:[7,14,30].map(e=>(0,t.jsxs)(E,{variant:a===e?"default":"outline",size:"sm",onClick:()=>s(e),className:"flex-1",children:[e,"D"]},e))}),(0,t.jsxs)("p",{className:"text-xs text-gray-500",children:["Normalizes all volume thresholds to ",a,"-day basis using simple multipliers"]}),(0,t.jsxs)("div",{className:"text-xs text-gray-500 space-y-1",children:[(0,t.jsx)("p",{children:"• 7D → 14D: \xd72 | 7D → 30D: \xd74"}),(0,t.jsx)("p",{children:"• 14D → 7D: \xf72 | 14D → 30D: \xd72"}),(0,t.jsx)("p",{children:"• 30D → 7D: \xf74 | 30D → 14D: \xf72"})]}),(0,t.jsxs)("div",{className:"mt-3 p-4 bg-blue-50 rounded border border-blue-200",children:[(0,t.jsx)("p",{className:"text-xs text-blue-800 font-medium mb-1",children:"\uD83D\uDCA1 Cumulative Fees"}),(0,t.jsx)("p",{className:"text-xs text-blue-700",children:"Hover over charts to see total fees paid to reach each volume threshold. Numbers in brackets show cumulative fees (area under the fee curve)."})]})]})})]})}Q.displayName=J.f.displayName;let ea=r.forwardRef((e,a)=>{let{className:s,type:r,...l}=e;return(0,t.jsx)("input",{type:r,className:S("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:a,...l})});ea.displayName="Input";var es=s(4845),et=s(3523),er=s(9224);let el=es.fC;es.ZA;let en=es.B4,ei=r.forwardRef((e,a)=>{let{className:s,children:r,...l}=e;return(0,t.jsxs)(es.xz,{ref:a,className:S("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...l,children:[r,(0,t.jsx)(es.JO,{asChild:!0,children:(0,t.jsx)(et.Z,{className:"h-4 w-4 opacity-50"})})]})});ei.displayName=es.xz.displayName;let ed=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(es.u_,{ref:a,className:S("flex cursor-default items-center justify-center py-1",s),...r,children:(0,t.jsx)(er.Z,{className:"h-4 w-4"})})});ed.displayName=es.u_.displayName;let ec=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(es.$G,{ref:a,className:S("flex cursor-default items-center justify-center py-1",s),...r,children:(0,t.jsx)(et.Z,{className:"h-4 w-4"})})});ec.displayName=es.$G.displayName;let eo=r.forwardRef((e,a)=>{let{className:s,children:r,position:l="popper",...n}=e;return(0,t.jsx)(es.h_,{children:(0,t.jsxs)(es.VY,{ref:a,className:S("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:l,...n,children:[(0,t.jsx)(ed,{}),(0,t.jsx)(es.l_,{className:S("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,t.jsx)(ec,{})]})})});eo.displayName=es.VY.displayName;let em=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(es.__,{ref:a,className:S("py-1.5 pl-8 pr-2 text-sm font-semibold",s),...r})});em.displayName=es.__.displayName;let ex=r.forwardRef((e,a)=>{let{className:s,children:r,...l}=e;return(0,t.jsxs)(es.ck,{ref:a,className:S("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...l,children:[(0,t.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,t.jsx)(es.wU,{children:(0,t.jsx)(B.Z,{className:"h-4 w-4"})})}),(0,t.jsx)(es.eT,{children:r})]})});ex.displayName=es.ck.displayName;let eu=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(es.Z0,{ref:a,className:S("-mx-1 my-1 h-px bg-muted",s),...r})});eu.displayName=es.Z0.displayName;var eh=s(5432),ef=s(2295),ep=s(9883),eg=s(5367);function ev(e){let{nadoData:a,onSave:s}=e,[l,n]=(0,r.useState)(!1),[i,d]=(0,r.useState)(a.day_basis),[c,o]=(0,r.useState)(!1),[m,x]=(0,r.useState)(null),[u,h]=(0,r.useState)(()=>a.maker_fees.map((e,s)=>{var t;return{volume:e.volume,makerFee:e.fee,takerFee:(null===(t=a.taker_fees[s])||void 0===t?void 0:t.fee)||0}})),f=async()=>{o(!0),x(null);try{let e={...a,day_basis:i,maker_fees:u.map(e=>({volume:e.volume,fee:e.makerFee})),taker_fees:u.map(e=>({volume:e.volume,fee:e.takerFee}))};await s(e),x({type:"success",text:"Nado fees updated successfully! Changes are now saved to the dataset."}),n(!1),setTimeout(()=>x(null),3e3)}catch(e){x({type:"error",text:"Failed to save changes. Please try again."})}finally{o(!1)}},p=(e,a,s)=>{h(t=>t.map((t,r)=>r===e?{...t,[a]:s}:t))},g=e=>{u.length>1&&h(a=>a.filter((a,s)=>s!==e))},v=e=>e>=1e3?"$".concat((e/1e3).toFixed(1),"B"):"$".concat(e.toFixed(0),"M");return l?(0,t.jsxs)(X,{className:"mb-6",children:[(0,t.jsxs)(A,{className:"pb-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)(T,{className:"text-lg",children:"Edit Nado Fee Configuration"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(E,{onClick:()=>{d(a.day_basis),h(a.maker_fees.map((e,s)=>{var t;return{volume:e.volume,makerFee:e.fee,takerFee:(null===(t=a.taker_fees[s])||void 0===t?void 0:t.fee)||0}}))},variant:"outline",size:"sm",children:[(0,t.jsx)(eh.Z,{className:"h-4 w-4 mr-1"}),"Reset"]}),(0,t.jsxs)(E,{onClick:f,size:"sm",disabled:c,children:[(0,t.jsx)(ef.Z,{className:"h-4 w-4 mr-1"}),c?"Saving...":"Save"]}),(0,t.jsx)(E,{onClick:()=>n(!1),variant:"outline",size:"sm",children:"Cancel"})]})]}),m&&(0,t.jsx)("div",{className:"mt-3 p-3 rounded text-sm ".concat("success"===m.type?"bg-green-50 text-green-800 border border-green-200":"bg-red-50 text-red-800 border border-red-200"),children:m.text})]}),(0,t.jsxs)(Z,{children:[(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)(Q,{htmlFor:"day-basis",className:"text-sm font-medium",children:"Rolling Period"}),(0,t.jsxs)(el,{value:i.toString(),onValueChange:e=>d(parseInt(e)),children:[(0,t.jsx)(ei,{className:"w-32 mt-1",children:(0,t.jsx)(en,{})}),(0,t.jsxs)(eo,{children:[(0,t.jsx)(ex,{value:"7",children:"7 days"}),(0,t.jsx)(ex,{value:"14",children:"14 days"}),(0,t.jsx)(ex,{value:"30",children:"30 days"})]})]})]}),(0,t.jsxs)("div",{className:"overflow-x-auto",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,t.jsx)("h4",{className:"text-sm font-medium text-gray-700",children:"Fee Schedule"}),(0,t.jsxs)(E,{onClick:()=>{let e=u[u.length-1],a=e?e.volume+1e3:1e3;h(e=>[...e,{volume:a,makerFee:0,takerFee:2.5}])},variant:"outline",size:"sm",children:[(0,t.jsx)(ep.Z,{className:"h-4 w-4 mr-1"}),"Add Tier"]})]}),(0,t.jsxs)("table",{className:"w-full text-sm",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"border-b",children:[(0,t.jsx)("th",{className:"text-left py-2 px-3",children:"Volume Threshold"}),(0,t.jsx)("th",{className:"text-left py-2 px-3",children:"Taker Fee (bps)"}),(0,t.jsx)("th",{className:"text-left py-2 px-3",children:"Maker Fee (bps)"}),(0,t.jsx)("th",{className:"text-left py-2 px-3",children:"Actions"})]})}),(0,t.jsx)("tbody",{children:u.map((e,a)=>(0,t.jsxs)("tr",{className:"border-b",children:[(0,t.jsx)("td",{className:"py-2 px-3",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-xs text-gray-500",children:"$"}),(0,t.jsx)(ea,{type:"number",value:e.volume,onChange:e=>p(a,"volume",parseFloat(e.target.value)||0),className:"w-24 h-8 text-xs",min:"0",step:"1"}),(0,t.jsx)("span",{className:"text-xs text-gray-500",children:"M"})]})}),(0,t.jsx)("td",{className:"py-2 px-3",children:(0,t.jsx)(ea,{type:"number",value:e.takerFee,onChange:e=>p(a,"takerFee",parseFloat(e.target.value)||0),className:"w-20 h-8 text-xs",step:"0.1"})}),(0,t.jsx)("td",{className:"py-2 px-3",children:(0,t.jsx)(ea,{type:"number",value:e.makerFee,onChange:e=>p(a,"makerFee",parseFloat(e.target.value)||0),className:"w-20 h-8 text-xs",step:"0.1"})}),(0,t.jsx)("td",{className:"py-2 px-3",children:(0,t.jsx)(E,{onClick:()=>g(a),variant:"ghost",size:"sm",disabled:1===u.length,className:"h-8 w-8 p-0 text-red-500 hover:text-red-700 hover:bg-red-50",children:(0,t.jsx)(eg.Z,{className:"h-4 w-4"})})})]},a))})]})]}),(0,t.jsxs)("div",{className:"mt-4 text-xs text-gray-500",children:[(0,t.jsx)("p",{children:"• Volume thresholds are in millions USD (e.g., 5 = $5M)"}),(0,t.jsx)("p",{children:"• Fees are in basis points (e.g., 1.5 = 1.5 bps = 0.015%)"}),(0,t.jsx)("p",{children:"• Rolling period determines the volume calculation timeframe"}),(0,t.jsx)("p",{children:"• Add tiers to create more granular fee structures"}),(0,t.jsx)("p",{children:"• Changes will update the chart immediately after saving"})]})]})]}):(0,t.jsxs)(X,{className:"mb-6",children:[(0,t.jsx)(A,{className:"pb-3",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)(T,{className:"text-lg",children:"Nado Fee Configuration"}),(0,t.jsxs)("div",{className:"text-sm text-gray-600",children:["Rolling Period: ",a.day_basis," days"]}),(0,t.jsx)(E,{onClick:()=>n(!0),variant:"outline",size:"sm",children:"Edit Fees"})]})}),(0,t.jsxs)(Z,{children:[m&&"success"===m.type&&(0,t.jsx)("div",{className:"mb-4 p-3 bg-green-50 text-green-800 border border-green-200 rounded text-sm",children:m.text}),(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full text-sm",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"border-b",children:[(0,t.jsx)("th",{className:"text-left py-2 px-3",children:"Volume Threshold"}),(0,t.jsx)("th",{className:"text-left py-2 px-3",children:"Taker Fee (bps)"}),(0,t.jsx)("th",{className:"text-left py-2 px-3",children:"Maker Fee (bps)"})]})}),(0,t.jsx)("tbody",{children:u.map((e,a)=>(0,t.jsxs)("tr",{className:"border-b",children:[(0,t.jsx)("td",{className:"py-2 px-3 font-medium",children:v(e.volume)}),(0,t.jsx)("td",{className:"py-2 px-3",children:e.takerFee.toFixed(1)}),(0,t.jsx)("td",{className:"py-2 px-3",children:e.makerFee.toFixed(1)})]},a))})]})})]})]})}function ej(e){let{initialData:a}=e,s=(0,l.useSearchParams)(),n=(0,l.useRouter)(),[i,d]=(0,r.useState)(a),[m,x]=(0,r.useState)(()=>{let e=s.get("exchanges");return e?e.split(","):["Nado"]}),[u,h]=(0,r.useState)(()=>{let e=s.get("dayBasis");return e?parseInt(e):14}),[p,g]=(0,r.useState)(!1),[v,j]=(0,r.useState)(2e9),y=async e=>{try{let a={...i,exchanges:i.exchanges.map(a=>"Nado"===a.exchange?e:a)};d(a);let s=await fetch("/api/update-dataset",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!s.ok)throw Error("Failed to save dataset");console.log("Nado data updated successfully")}catch(e){console.error("Error updating Nado data:",e)}};(0,r.useEffect)(()=>{let e=new URLSearchParams;m.length>0&&e.set("exchanges",m.join(",")),14!==u&&e.set("dayBasis",u.toString());let a=e.toString()?"?".concat(e.toString()):"";a?n.replace(a):n.replace(window.location.pathname)},[m,u,n]);let b=(0,r.useMemo)(()=>i.exchanges.filter(e=>"perp"===e.product).map(e=>{let a;return e.day_basis===u?e:(a=7===e.day_basis&&14===u?2:7===e.day_basis&&30===u?4:14===e.day_basis&&7===u?.5:14===e.day_basis&&30===u?2:30===e.day_basis&&7===u?.25:30===e.day_basis&&14===u?.5:u/e.day_basis,{...e,day_basis:u,maker_fees:e.maker_fees.map(e=>({...e,volume:e.volume*a})),taker_fees:e.taker_fees.map(e=>({...e,volume:e.volume*a}))})}),[i,u]),N=(0,r.useMemo)(()=>b.filter(e=>m.includes(e.exchange)),[b,m]),{volumeDomain:k,makerFeeDomain:F,takerFeeDomain:C}=(0,r.useMemo)(()=>{if(0===N.length)return{volumeDomain:[0,1e7],makerFeeDomain:[-5,10],takerFeeDomain:[0,10]};let e=1/0,a=0,s=1/0,t=-1/0,r=1/0,l=-1/0;N.forEach(n=>{n.maker_fees.forEach(r=>{e=Math.min(e,r.volume),a=Math.max(a,r.volume),s=Math.min(s,r.fee),t=Math.max(t,r.fee)}),n.taker_fees.forEach(s=>{e=Math.min(e,s.volume),a=Math.max(a,s.volume),r=Math.min(r,s.fee),l=Math.max(l,s.fee)})});let n=(a-e)*.1,i=Math.max(1,(t-s)*.3),d=Math.max(1,(l-r)*.3);return{volumeDomain:[0,a+n],makerFeeDomain:[Math.min(s-i,-3),t+i],takerFeeDomain:[Math.min(r-d,-1),l+d]}},[N]),_=(0,r.useMemo)(()=>{if(!v||0===N.length)return{maker:[],taker:[]};let e=N.map(e=>({exchange:e.exchange,type:e.type,makerFee:c(e.maker_fees,v),takerFee:c(e.taker_fees,v),makerCumulativeFees:o(e.maker_fees,v),takerCumulativeFees:o(e.taker_fees,v)})).sort((e,a)=>e.makerFee!==a.makerFee?e.makerFee-a.makerFee:e.takerFee!==a.takerFee?e.takerFee-a.takerFee:e.exchange.localeCompare(a.exchange)),a=[...e].sort((e,a)=>e.takerFee!==a.takerFee?e.takerFee-a.takerFee:e.makerFee!==a.makerFee?e.makerFee-a.makerFee:e.exchange.localeCompare(a.exchange));return{maker:e,taker:a}},[N,v]),D=e=>{if(null===e){j(null);return}j(e)},M=i.exchanges.find(e=>"Nado"===e.exchange);return(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[(0,t.jsxs)("div",{className:"lg:col-span-1 space-y-6",children:[(0,t.jsx)($,{exchanges:b,originalExchanges:i.exchanges.filter(e=>"perp"===e.product),selectedExchanges:m,onSelectionChange:x}),(0,t.jsx)(ee,{dayBasis:u,onDayBasisChange:h,isLogScale:p,onLogScaleChange:g})]}),(0,t.jsxs)("div",{className:"lg:col-span-3 space-y-6",children:[M&&(0,t.jsx)(ev,{nadoData:M,onSave:y}),N.length>0&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"bg-white rounded-lg border shadow-sm p-6",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Taker Fees (bps)"}),(0,t.jsx)(w,{exchanges:N,feeType:"taker",volumeDomain:k,feeDomain:C,isLogScale:p,hoverVolume:v,onHoverChange:D,colors:f})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg border shadow-sm p-6",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Maker Fees (bps)"}),(0,t.jsx)(w,{exchanges:N,feeType:"maker",volumeDomain:k,feeDomain:F,isLogScale:p,hoverVolume:v,onHoverChange:D,colors:f})]})]}),v&&N.length>0&&(0,t.jsx)(Y,{rankings:_,hoverVolume:v,chartColors:f})]})]})}}},function(e){e.O(0,[497,971,864,744],function(){return e(e.s=8972)}),_N_E=e.O()}]);